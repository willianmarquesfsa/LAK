"use strict";(function(){jQuery(function(i){var e,c,u,t,n,r,a,o;if(i(".tips, .help_tip, .woocommerce-help-tip").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:200}),"wc_order_status"!==pagenow&&"edit-wc_order_status"!==pagenow&&"wc_order_status_manager_setup"!==pagenow&&"plugins"!==pagenow||i.extend(!0,i.magnificPopup.defaults,{tClose:wc_order_status_manager.i18n.close}),"wc_order_status"!==pagenow&&"edit-wc_order_status"!==pagenow&&"wc_order_status_manager_setup"!==pagenow||(u=i("#reassign-order-status"),c=i("#reassign-order-status-popup"),u.magnificPopup({inline:!0,callbacks:{open:function(){return c.show()},close:function(){return c.hide()}}}),i("a.submitdelete").on("click",function(t){var a,e,o,s;if(t.preventDefault(),s=this,o="wc_order_status"===pagenow?(e=i("#post_ID").val(),i("#post_name").val()):(e=i(this).closest("tr").attr("id").substr(5),i(this).closest("tr").find("td.column-slug").text()),e)return a={action:"wc_order_status_manager_can_safely_delete_order_status",security:wc_order_status_manager.delete_order_status_nonce,status:e},i.post(wc_order_status_manager.ajax_url,a,function(e){var t,n,r;return e.success?window.location=i(s).attr("href"):(c.find(".order-status-link").attr("href",e.data.orders_link),c.find(".order-status-count").text(e.data.orders_count),c.find(".order-status-name").text(e.data.status_name),n=c.find(".singular"),t=c.find(".plural"),1===e.data.orders_count?(n.show(),t.hide()):(n.hide(),t.show()),t=c.find("select"),r="",t.html(" "),i.each(wc_order_status_manager.order_statuses,function(t,e){if(t!==o)return r+='<option value="'+t+'">'+e+"</option>"}),c.find("select").html(r),u.trigger("click"),c.removeClass("mfp-hide"),c.find("button").on("click",function(t){return i(this).hasClass("reassign")?(a={action:"wc_order_status_manager_bulk_reassign_order_status",security:wc_order_status_manager.bulk_reassign_order_status_nonce,old_status:e.data.status_name,new_status:c.find("select").val()},i.post(wc_order_status_manager.ajax_url,a,function(t){return window.location=i(s).attr("href")})):i(this).hasClass("delete")?window.location=i(s).attr("href"):void 0}))})})),"edit-wc_order_status"===pagenow&&((t=i("#the-list")).sortable({placeholder:"ui-state-highlight",stop:function(){var t,e=[];return i("#the-list > tr ").each(function(){return e.push(i(this).find("td.slug").text())}),t={action:"wc_order_status_manager_sort_order_statuses",security:wc_order_status_manager.sort_order_statuses_nonce,statuses:e},i.post(wc_order_status_manager.ajax_url,t,function(t){})}}),t.disableSelection(),i("#import-custom-statuses").on("click",function(t){return t.preventDefault(),t={action:"wc_order_status_manager_import_custom_order_statuses",security:wc_order_status_manager.import_custom_order_statuses_nonce},i.post(wc_order_status_manager.ajax_url,t,function(t){return location.reload()})})),"wc_order_status"!==pagenow&&"wc_order_status_manager_setup"!==pagenow||(i("#_next_statuses").select2(),i("#_color").wpColorPicker({change:function(t,e){return i("._icon_field .selected-icon").css("color",e.color.toString())}}),i(document).mousedown(function(t){if(!i(t.target).parents(".wp-picker-holder")&&!i(t.target).parents("mark"))return i(".wp-picker-holder").each(function(){return i(this).fadeOut()})}),o=function(t,e){e=e?"url("+e+")":"none";return i(t).siblings("select").val(""),i(t).siblings(".icons-selector").find(".current-icon").removeClass("current-icon"),i(t).siblings(".icons-selector").find(".selected-icon i").removeClass().css("background-image",e)},i("#_icon, #_action_icon").each(function(){var e,t;return i(this).fontIconPicker({allCategoryText:wc_order_status_manager.i18n.all_icon_packages,source:wc_order_status_manager.icon_options}),(e=i(this).siblings(".icons-selector")).find(".fip-box:has(.fip-icon-block)").attr("title",wc_order_status_manager.i18n.remove_icon),e.find(".selector").addClass("button button-small"),i(this).on("change",function(t){if(i(this).val())return e.find(".selected-icon i").css("background-image","")}),(t=i(this).data("icon-image"))&&o(this,t),i(this).siblings(".upload-icon, .remove-icon").detach().insertAfter(i(this).siblings(".icons-selector").find(".selector"))}),i(".icons-selector .selector-button").attr("title",wc_order_status_manager.i18n.select_icon),i(".icons-search-input").attr("placeholder",wc_order_status_manager.i18n.search_icons),i("._icon_field .selected-icon").css("color",i("#_color").val()),r={},i(".upload-icon").on("click",function(t){var n;return t.preventDefault(),n=i(this).attr("href"),r[n]||(r[n]=wp.media.frames["file_frame_"+n]=wp.media({title:wc_order_status_manager.i18n.choose_file,button:{text:i(this).data("uploader-button-text")},multiple:!1}),r[n].on("select",function(t){var e=r[n].state().get("selection").first().toJSON();return i(n).val(e.id),i(n).siblings(".icons-selector").find(".selected-icon i").css("background-image","").removeClass().addClass("fa fa-refresh fa-spin"),i.get(wc_order_status_manager.ajax_url,{attachment_id:e.id,action:"wc_order_status_manager_get_icon_image_url"},function(t){if(-1!==t.indexOf("http"))return o(n,t)})})),r[n].open()}),i(".remove-icon").on("click",function(t){return t.preventDefault(),o(i(this).attr("href")),i(i(this).attr("href")).val("")}),i("#post_name").on("keyup",function(t){var e=i(".wc-prefix-disallowed");if(i(this).val().startsWith("wc-")){if(i(this).css("color","#A00000"),0===e.length)return i(this).after('<span class="wc-prefix-disallowed description" style="color:#A00000;display:inline-flex;">'+wc_order_status_manager.i18n.wc_prefix_disallowed+"</p>")}else if(i(this).css("color","#32373C"),0<e.length)return e.remove()}).trigger("keyup")),"wc_order_email"===pagenow&&(i(".dispatch_conditions").on("click",".remove-condition",function(t){if(window.confirm(wc_order_status_manager.i18n.remove_this_condition)&&(i(t.target).parents("tr").remove(),!i(".dispatch_conditions tbody").children().length))return i(".dispatch_conditions tbody, .dispatch_conditions thead").hide()}),i(".dispatch_conditions").on("click",".add-condition",function(t){var e=i(".dispatch_conditions tr.condition").length,n='<option value="any">'+wc_order_status_manager.i18n.any+"</option>";return i.each(wc_order_status_manager.order_statuses,function(t,e){return n+='<option value="'+t+'">'+e+"</option>"}),i(".dispatch_conditions thead").show(),i(".dispatch_conditions tbody").show().append('<tr class="condition"><td><select name="_email_dispatch_condition['+e+'][from]">'+n+'</select></td><td><select name="_email_dispatch_condition['+e+'][to]">'+n+'</select></td><td><button type="button" class="button remove-condition">'+wc_order_status_manager.i18n.remove+"</button></td></tr>")}),i(".save_order_status_email").on("click",function(t){var e=!1;if(i(".dispatch_conditions tr.condition").each(function(){var t="";if(!e)return i("select").each(function(){return e="any"===i(this).val()&&"any"===t,t=i(this).val()})}),e&&!window.confirm(wc_order_status_manager.i18n.confirm_any_status))return t.preventDefault()})),e=i("#order-status-plugin-deactivation"),"plugins"===pagenow&&e.length)return c=i("#order-status-plugin-deactivation-popup"),e.magnificPopup({inline:!0,callbacks:{open:function(){return c.show()},close:function(){return c.hide()}}}),n=i('#deactivate-woocommerce-order-status-manager, #deactivate-woocommerce-com-woocommerce-order-status-manager, [data-slug="woocommerce-order-status-manager"] .deactivate a'),a=!1,n.on("click",function(t){if(!a)return t.preventDefault(),c.find(".cancel, .deactivate").on("click",function(t){return c.find(".mfp-close").trigger("click")}),c.find(".deactivate").on("click",function(t){return window.location.href=n.attr("href")}),c.find("#order-status-plugin-deactivation-popup-dont-show-me-again").on("change",function(t){var e;return a=i(this).prop("checked"),e={action:"wc_order_status_manager_set_deactivation_confirmation_state",security:wc_order_status_manager.set_deactivation_confirmation_state,disabled:a},i.post(wc_order_status_manager.ajax_url,e)}),e.trigger("click")})})}).call(void 0);